<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><meta name="description" content="Fit a non-stationary Poisson-GP model for several thresholds given
in the rqTList object thresholds corresponding to a
vector of probability."><title>Fit a non-stationary Poisson-GP Model using several
    Thresholds computed by Quantile Regression. — pgpTList • dailymet</title><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- bootstrap-toc --><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@v1.0.1/dist/bootstrap-toc.min.js" integrity="sha256-4veVQbu7//Lk5TSmc7YV48MxtMy98e26cf5MrgZYnwo=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Fit a non-stationary Poisson-GP Model using several
    Thresholds computed by Quantile Regression. — pgpTList"><meta property="og:description" content="Fit a non-stationary Poisson-GP model for several thresholds given
in the rqTList object thresholds corresponding to a
vector of probability."><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-light navbar-expand-lg bg-light"><div class="container">
    
    <a class="navbar-brand me-2" href="../index.html">dailymet</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.1.7</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="active nav-item">
  <a class="nav-link" href="../reference/index.html">Reference</a>
</li>
<li class="nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-articles">Articles</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-articles">
    <a class="dropdown-item" href="../articles/Intro.html">R Package `dailymet`: Overview</a>
  </div>
</li>
<li class="nav-item">
  <a class="nav-link" href="../news/index.html">Changelog</a>
</li>
      </ul><form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off"></form>

      <ul class="navbar-nav"></ul></div>

    
  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="" class="logo" alt=""><h1>Fit a non-stationary Poisson-GP Model using several
    Thresholds computed by Quantile Regression.</h1>
      
      <div class="d-none name"><code>pgpTList.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>Fit a non-stationary Poisson-GP model for several thresholds given
in the <code>rqTList</code> object <code>thresholds</code> corresponding to a
vector of probability.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">pgpTList</span><span class="op">(</span></span>
<span>  <span class="va">dailyMet</span>,</span>
<span>  subset <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  <span class="va">thresholds</span>,</span>
<span>  declust <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  tauRef <span class="op">=</span> <span class="fl">0.95</span>,</span>
<span>  fitLambda <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  logLambda.fun <span class="op">=</span> <span class="op">~</span><span class="fl">1</span>,</span>
<span>  scale.fun <span class="op">=</span> <span class="op">~</span><span class="va">Cst</span> <span class="op">+</span> <span class="va">sinjPhi1</span> <span class="op">+</span> <span class="va">sinjPhi2</span> <span class="op">+</span> <span class="va">sinjPhi3</span> <span class="op">-</span> <span class="fl">1</span>,</span>
<span>  shape.fun <span class="op">=</span> <span class="op">~</span><span class="fl">1</span>,</span>
<span>  extraDesign <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  trace <span class="op">=</span> <span class="fl">1</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>
    <dl><dt>dailyMet</dt>
<dd><p>An object with class <code>"dailyMet"</code> containing
the data.</p></dd>


<dt>subset</dt>
<dd><p>A character defining a condition used to subset the
data, typically to select a period within the year e.g.,
summer. Note that the condition is applied <em>after
declustering</em> and there are side effects: The exceedances in
the first two days or last two days of a period within year
may be lost. <em>NOT IMPLEMENTED YET</em>. Note that the
condition is used only for the Extreme Value part of the
model, not on the determination of the threshold. Therefore,
<em>the fitted thresholds remain unchanged</em> whether the the
condition is used or not.</p></dd>


<dt>thresholds</dt>
<dd><p>An object with class <code>"rqTList"</code> containing
the thresholds.</p></dd>


<dt>declust</dt>
<dd><p>Logical. If <code>TRUE</code> the exceedances over each
threshold will be declustered.</p></dd>


<dt>tauRef</dt>
<dd><p>The reference probability defining the quantile
regression fit that will be used to define the phases of the
sine waves.</p></dd>


<dt>fitLambda</dt>
<dd><p>Logical. If <code>TRUE</code> the temporal Poisson
process is fitted, using the formula <code>logLambda.fun</code>.</p></dd>


<dt>logLambda.fun</dt>
<dd><p>Formula for the log-rate of the time Poisson
process. For now, there are only a few possibilities. See
<b>Details</b>. Mind that <em>only numeric covariates can be
used</em>.</p></dd>


<dt>scale.fun, shape.fun</dt>
<dd><p>Formulas for the GP scale and shape as
in <code><a href="https://rdrr.io/pkg/extRemes/man/fevd.html" class="external-link">fevd</a></code>.</p></dd>


<dt>extraDesign</dt>
<dd><p>A list with a specific structure used to
generate extra "design variables" that can be used in
formulas, see <b>Examples</b> and the help of
<code><a href="designVars.html">designVars</a></code> and <code><a href="rqTList.html">rqTList</a></code> for
examples of syntax. By default a trigonometric design with
three harmonics is used, along with the sinus waves basis
corresponding to the phases of the reference threshold defined
by <code>tauRef</code>. The sinus wave variables are created by
using the <code><a href="sinBasis.html">sinBasis</a></code> function with the relevant
value of <code>phi</code>.</p></dd>


<dt>trace</dt>
<dd><p>Integer level of verbosity.</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    

<p>An object with class <code>"pgpTList"</code>. This is a list with
    the following elements</p>
<p></p>
<ul><li><p><code>tau</code>             The vector of probabilities extracted from
            <code>thresholds</code>.</p></li>
<li><p><code>thresholds</code>             A copy of <code>thresholds</code> as given on entry.</p></li>
<li><p><code>GP</code>             A list with class <code><a href="fevdTList.html">fevdTList</a></code></p></li>
<li><p><code>logLambda.fun</code>, <code>scale.fun</code>, <code>scale.fun</code>              The formulas used for the "GP part" of the model.</p></li>
</ul></div>
    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>
    <p>For each probability <code>tau[i]</code></p><ul><li><p>Find the exceedances over the threshold corresponding
        to the probability <code>tau[i]</code>, and decluster these
        if wanted.</p></li>
<li><p>Fit a non-stationary GP model using
        <code><a href="https://rdrr.io/pkg/extRemes/man/fevd.html" class="external-link">extRemes::fevd</a></code> with <code>type = "GP"</code> and
        with the formulas prescribed.</p></li>
<li><p>Fit a non-stationary temporal Poisson process model using
        <code><a href="https://rdrr.io/pkg/NHPoisson/man/fitPP.fun.html" class="external-link">NHPoisson::fitPP.fun</a></code>.</p></li>
</ul><p>The formula given in <code>logLambda.fun</code> will typically involve
<code>YearNum</code>. Note that the constant is alaways included by
the function <code><a href="https://rdrr.io/pkg/NHPoisson/man/fitPP.fun.html" class="external-link">NHPoisson::fitPP.fun</a></code> so it should be discarded
from the formula when covariates are used. For instance in order
to use the covariare <code>YearNum</code> we must use the formla
<code>~ YearNum -1</code>.</p>
    </div>
    <div class="section level2">
    <h2 id="note">Note<a class="anchor" aria-label="anchor" href="#note"></a></h2>
    <p>The use of <code>subset</code>, still experimental, is aimed to
    focus the estimation on a period <em>within the year</em>,
    typically summer or winter. This should not be used to use a
    shorter timeseries. The rate of the temporal Poisson process
    is computed on the basis of the full times series, not on the
    basis of the cumulated duration of the subset. For instance if
    <code>subset</code> selects 6 months in a year and if the timeseries
    duration is 60 year, then the rate is still computed on the
    basis of a 60-year duration, not on a 30-year duration.</p>
    </div>
    <div class="section level2">
    <h2 id="caution">Caution<a class="anchor" aria-label="anchor" href="#caution"></a></h2>
    <p>At the time being, a <code>pgpTList</code> object is
    not a list of <code>pgp</code> objects. The output is likely to be
    re-designed, so a <code>pgpTList</code> object is better used via
    methods.</p>
    </div>
    <div class="section level2">
    <h2 id="see-also">See also<a class="anchor" aria-label="anchor" href="#see-also"></a></h2>
    <div class="dont-index"><p><code><a href="rqTList.html">rqTList</a></code> for the list of <code>rq</code> objects
    as used in <code>thresholds</code>, and <code><a href="fevdTList.html">fevdTList</a></code> for
    the list of <code>fevd</code> objects as returned in the <code>GP</code>
    element of the result.</p></div>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="co">## define the thresholds with the default seasonality, see 'rqTList'</span></span></span>
<span class="r-in"><span><span class="va">Rq</span> <span class="op">&lt;-</span> <span class="fu"><a href="rqTList.html">rqTList</a></span><span class="op">(</span>dailyMet <span class="op">=</span> <span class="va">Rennes</span>,</span></span>
<span class="r-in"><span>              tau <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.94</span>, <span class="fl">0.95</span>, <span class="fl">0.96</span>, <span class="fl">0.97</span>, <span class="fl">0.98</span>, <span class="fl">0.99</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## fit</span></span></span>
<span class="r-in"><span><span class="va">Pgp1</span> <span class="op">&lt;-</span> <span class="fu">pgpTList</span><span class="op">(</span>dailyMet <span class="op">=</span> <span class="va">Rennes</span>, thresholds <span class="op">=</span> <span class="va">Rq</span>,</span></span>
<span class="r-in"><span>                 declust <span class="op">=</span> <span class="cn">TRUE</span>,</span></span>
<span class="r-in"><span>                 fitLambda <span class="op">=</span> <span class="cn">TRUE</span>, logLambda.fun <span class="op">=</span> <span class="op">~</span> <span class="va">YearNum</span> <span class="op">-</span> <span class="fl">1</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> o Using meteorological variable : "TX"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> o Adding new variables </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> o Using K = 3 and the following phases</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> sinjPhi1 sinjPhi2 sinjPhi3 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   105.94     8.53    84.21 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> o Sampling rate : 365.26/year</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> o Looping on 6 thresholds</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> o Fit the temporal Poisson process:  non-homogeneous</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Number of observations  not used in the estimation process:  0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Total number of time observations:  28366</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Number of events:  772</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Convergence code:  0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Convergence attained</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Loglikelihood:  -3537.078</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Estimated coefficients: </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     b0     b1 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> -3.757  0.009 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Full coefficients: </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     b0     b1 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> -3.757  0.009 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> attr(,"TypeCoeff")</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "Fixed: No  fixed parameters"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> o Fit the temporal Poisson process:  non-homogeneous</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Number of observations  not used in the estimation process:  0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Total number of time observations:  28366</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Number of events:  671</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Convergence code:  0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Convergence attained</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Loglikelihood:  -3165.859</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Estimated coefficients: </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     b0     b1 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> -3.912  0.010 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Full coefficients: </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     b0     b1 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> -3.912  0.010 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> attr(,"TypeCoeff")</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "Fixed: No  fixed parameters"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> o Fit the temporal Poisson process:  non-homogeneous</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Number of observations  not used in the estimation process:  0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Total number of time observations:  28366</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Number of events:  565</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Convergence code:  0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Convergence attained</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Loglikelihood:  -2762.467</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Estimated coefficients: </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     b0     b1 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> -4.087  0.010 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Full coefficients: </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     b0     b1 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> -4.087  0.010 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> attr(,"TypeCoeff")</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "Fixed: No  fixed parameters"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> o Fit the temporal Poisson process:  non-homogeneous</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Number of observations  not used in the estimation process:  0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Total number of time observations:  28366</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Number of events:  450</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Convergence code:  0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Convergence attained</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Loglikelihood:  -2299.813</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Estimated coefficients: </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     b0     b1 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> -4.337  0.012 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Full coefficients: </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     b0     b1 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> -4.337  0.012 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> attr(,"TypeCoeff")</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "Fixed: No  fixed parameters"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> o Fit the temporal Poisson process:  non-homogeneous</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Number of observations  not used in the estimation process:  0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Total number of time observations:  28366</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Number of events:  323</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Convergence code:  0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Convergence attained</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Loglikelihood:  -1749.224</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Estimated coefficients: </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     b0     b1 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> -4.754  0.016 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Full coefficients: </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     b0     b1 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> -4.754  0.016 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> attr(,"TypeCoeff")</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "Fixed: No  fixed parameters"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> o Fit the temporal Poisson process:  non-homogeneous</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Number of observations  not used in the estimation process:  0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Total number of time observations:  28366</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Number of events:  179</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Convergence code:  0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Convergence attained</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Loglikelihood:  -1072.212</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Estimated coefficients: </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     b0     b1 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> -5.389  0.018 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Full coefficients: </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     b0     b1 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> -5.389  0.018 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> attr(,"TypeCoeff")</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "Fixed: No  fixed parameters"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## try a varying GP shape 'xi'</span></span></span>
<span class="r-in"><span><span class="kw">if</span> <span class="op">(</span><span class="cn">FALSE</span><span class="op">)</span> <span class="op">{</span></span></span>
<span class="r-in"><span>    <span class="va">Pgp2</span> <span class="op">&lt;-</span> <span class="fu">pgpTList</span><span class="op">(</span>dailyMet <span class="op">=</span> <span class="va">Rennes</span>, thresholds <span class="op">=</span> <span class="va">Rq</span>,</span></span>
<span class="r-in"><span>                     declust <span class="op">=</span> <span class="cn">TRUE</span>, </span></span>
<span class="r-in"><span>                     shape.fun <span class="op">=</span> <span class="op">~</span> <span class="va">Cst</span> <span class="op">+</span> <span class="va">sinjPhi1</span> <span class="op">+</span> <span class="va">sinjPhi2</span> <span class="op">+</span> <span class="va">sinjPhi3</span> <span class="op">-</span> <span class="fl">1</span>,</span></span>
<span class="r-in"><span>                     fitLambda <span class="op">=</span> <span class="cn">TRUE</span>, logLambda.fun <span class="op">=</span> <span class="op">~</span> <span class="va">YearNum</span> <span class="op">-</span> <span class="fl">1</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="op">}</span></span></span>
<span class="r-in"><span><span class="co">## plot one year to </span></span></span>
<span class="r-in"><span><span class="va">predYear</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/predict.html" class="external-link">predict</a></span><span class="op">(</span><span class="va">Pgp1</span>, last <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">gYear</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/autoplot.html" class="external-link">autoplot</a></span><span class="op">(</span><span class="va">predYear</span>, facet <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">gYear</span></span></span>
<span class="r-plt img"><img src="pgpTList-1.png" alt="" width="700" height="433"></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## show the evolution of the exceedance rate on the long-run</span></span></span>
<span class="r-in"><span><span class="va">predAll</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/predict.html" class="external-link">predict</a></span><span class="op">(</span><span class="va">Pgp1</span>, last <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">exceed</span> <span class="op">&lt;-</span> <span class="fu"><a href="exceed.html">exceed</a></span><span class="op">(</span><span class="va">Pgp1</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">gAll</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/autoplot.html" class="external-link">autoplot</a></span><span class="op">(</span><span class="va">predAll</span>, which <span class="op">=</span> <span class="st">"lambda"</span>, size <span class="op">=</span> <span class="fl">1.2</span><span class="op">)</span> <span class="op">+</span></span></span>
<span class="r-in"><span>            <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html" class="external-link">geom_point</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">exceed</span>, mapping <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">Date</span>, y <span class="op">=</span> <span class="va">Nb</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span></span>
<span class="r-in"><span>                <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">ggtitle</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste</a></span><span class="op">(</span><span class="st">"Fitted rate 'lambda' and annual number of"</span>,</span></span>
<span class="r-in"><span>                              <span class="st">"declustered exceedances"</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">gAll</span></span></span>
<span class="r-plt img"><img src="pgpTList-2.png" alt="" width="700" height="433"></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## Add an extra design corresponding to broken line splines. This</span></span></span>
<span class="r-in"><span><span class="co">## creates a new variable 't1_1970' that can be used in formula to</span></span></span>
<span class="r-in"><span><span class="co">## assess a possible change in the trend at the beginning of the seventies.</span></span></span>
<span class="r-in"><span><span class="va">Pgp3</span> <span class="op">&lt;-</span></span></span>
<span class="r-in"><span>    <span class="fu">pgpTList</span><span class="op">(</span>dailyMet <span class="op">=</span> <span class="va">Rennes</span>, thresholds <span class="op">=</span> <span class="va">Rq</span>,</span></span>
<span class="r-in"><span>             declust <span class="op">=</span> <span class="cn">TRUE</span>,</span></span>
<span class="r-in"><span>             fitLambda <span class="op">=</span> <span class="cn">TRUE</span>,</span></span>
<span class="r-in"><span>             logLambda.fun <span class="op">=</span> <span class="op">~</span> <span class="va">YearNum</span> <span class="op">+</span> <span class="va">t1_1970</span> <span class="op">-</span> <span class="fl">1</span>,</span></span>
<span class="r-in"><span>             extraDesign <span class="op">=</span></span></span>
<span class="r-in"><span>                 <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="st">"breaks"</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>what <span class="op">=</span> <span class="st">"NSGEV::breaksX"</span>,</span></span>
<span class="r-in"><span>                                      args <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>breaks <span class="op">=</span> <span class="st">"1970-01-01"</span><span class="op">)</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> o Using meteorological variable : "TX"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> o Adding new variables </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> o Using K = 3 and the following phases</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> sinjPhi1 sinjPhi2 sinjPhi3 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   105.94     8.53    84.21 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    o evaluation of `NSGEV::breaksX`. Date is added in 1-st arg `date`</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> o Sampling rate : 365.26/year</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> o Looping on 6 thresholds</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> o Fit the temporal Poisson process:  non-homogeneous</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Number of observations  not used in the estimation process:  0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Total number of time observations:  28366</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Number of events:  772</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Convergence code:  0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Convergence attained</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Loglikelihood:  -3521.467</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Estimated coefficients: </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     b0     b1     b2 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> -4.108 -0.026  0.046 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Full coefficients: </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     b0     b1     b2 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> -4.108 -0.026  0.046 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> attr(,"TypeCoeff")</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "Fixed: No  fixed parameters"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> o Fit the temporal Poisson process:  non-homogeneous</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Number of observations  not used in the estimation process:  0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Total number of time observations:  28366</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Number of events:  671</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Convergence code:  0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Convergence attained</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Loglikelihood:  -3151.093</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Estimated coefficients: </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     b0     b1     b2 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> -4.280 -0.027  0.049 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Full coefficients: </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     b0     b1     b2 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> -4.280 -0.027  0.049 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> attr(,"TypeCoeff")</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "Fixed: No  fixed parameters"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> o Fit the temporal Poisson process:  non-homogeneous</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Number of observations  not used in the estimation process:  0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Total number of time observations:  28366</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Number of events:  565</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Convergence code:  0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Convergence attained</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Loglikelihood:  -2746.698</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Estimated coefficients: </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     b0     b1     b2 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> -4.505 -0.032  0.055 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Full coefficients: </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     b0     b1     b2 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> -4.505 -0.032  0.055 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> attr(,"TypeCoeff")</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "Fixed: No  fixed parameters"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> o Fit the temporal Poisson process:  non-homogeneous</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Number of observations  not used in the estimation process:  0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Total number of time observations:  28366</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Number of events:  450</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Convergence code:  0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Convergence attained</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Loglikelihood:  -2286.767</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Estimated coefficients: </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     b0     b1     b2 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> -4.765 -0.032  0.056 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Full coefficients: </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     b0     b1     b2 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> -4.765 -0.032  0.056 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> attr(,"TypeCoeff")</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "Fixed: No  fixed parameters"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> o Fit the temporal Poisson process:  non-homogeneous</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Number of observations  not used in the estimation process:  0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Total number of time observations:  28366</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Number of events:  323</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Convergence code:  0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Convergence attained</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Loglikelihood:  -1738.267</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Estimated coefficients: </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     b0     b1     b2 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> -5.223 -0.034  0.063 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Full coefficients: </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     b0     b1     b2 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> -5.223 -0.034  0.063 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> attr(,"TypeCoeff")</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "Fixed: No  fixed parameters"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> o Fit the temporal Poisson process:  non-homogeneous</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Number of observations  not used in the estimation process:  0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Total number of time observations:  28366</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Number of events:  179</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Convergence code:  0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Convergence attained</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Loglikelihood:  -1066.829</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Estimated coefficients: </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    b0    b1    b2 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> -5.83 -0.03  0.06 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Full coefficients: </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    b0    b1    b2 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> -5.83 -0.03  0.06 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> attr(,"TypeCoeff")</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "Fixed: No  fixed parameters"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-in"><span><span class="va">p3</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/predict.html" class="external-link">predict</a></span><span class="op">(</span><span class="va">Pgp3</span>,</span></span>
<span class="r-in"><span>              newdata <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span>Date <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span>from <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/as.Date.html" class="external-link">as.Date</a></span><span class="op">(</span><span class="st">"2024-01-01"</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>                                   to <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/as.Date.html" class="external-link">as.Date</a></span><span class="op">(</span><span class="st">"2054-01-01"</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>                                   by <span class="op">=</span> <span class="st">"day"</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/autoplot.html" class="external-link">autoplot</a></span><span class="op">(</span><span class="va">p3</span>, facet <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="pgpTList-3.png" alt="" width="700" height="433"></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## simulate </span></span></span>
<span class="r-in"><span><span class="va">s3</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/simulate.html" class="external-link">simulate</a></span><span class="op">(</span><span class="va">Pgp3</span>, nsim <span class="op">=</span> <span class="fl">10</span>,</span></span>
<span class="r-in"><span>              newdata <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span>Date <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span>from <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/as.Date.html" class="external-link">as.Date</a></span><span class="op">(</span><span class="st">"2024-01-01"</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>                                   to <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/as.Date.html" class="external-link">as.Date</a></span><span class="op">(</span><span class="st">"2054-01-01"</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>                                   by <span class="op">=</span> <span class="st">"day"</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> <span class="warning">Warning: </span>collapsing to unique 'x' values</span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> <span class="warning">Warning: </span>collapsing to unique 'x' values</span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> <span class="warning">Warning: </span>collapsing to unique 'x' values</span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> <span class="warning">Warning: </span>collapsing to unique 'x' values</span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> <span class="warning">Warning: </span>collapsing to unique 'x' values</span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> <span class="warning">Warning: </span>collapsing to unique 'x' values</span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> <span class="warning">Warning: </span>collapsing to unique 'x' values</span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> <span class="warning">Warning: </span>collapsing to unique 'x' values</span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> <span class="warning">Warning: </span>collapsing to unique 'x' values</span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> <span class="warning">Warning: </span>collapsing to unique 'x' values</span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> <span class="warning">Warning: </span>collapsing to unique 'x' values</span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> <span class="warning">Warning: </span>collapsing to unique 'x' values</span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> <span class="warning">Warning: </span>collapsing to unique 'x' values</span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> <span class="warning">Warning: </span>collapsing to unique 'x' values</span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> <span class="warning">Warning: </span>collapsing to unique 'x' values</span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> <span class="warning">Warning: </span>collapsing to unique 'x' values</span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> <span class="warning">Warning: </span>collapsing to unique 'x' values</span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> <span class="warning">Warning: </span>collapsing to unique 'x' values</span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> <span class="warning">Warning: </span>collapsing to unique 'x' values</span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> <span class="warning">Warning: </span>collapsing to unique 'x' values</span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> <span class="warning">Warning: </span>collapsing to unique 'x' values</span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> <span class="warning">Warning: </span>collapsing to unique 'x' values</span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> <span class="warning">Warning: </span>collapsing to unique 'x' values</span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> <span class="warning">Warning: </span>collapsing to unique 'x' values</span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> <span class="warning">Warning: </span>collapsing to unique 'x' values</span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> <span class="warning">Warning: </span>collapsing to unique 'x' values</span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> <span class="warning">Warning: </span>collapsing to unique 'x' values</span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> <span class="warning">Warning: </span>collapsing to unique 'x' values</span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> <span class="warning">Warning: </span>collapsing to unique 'x' values</span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> <span class="warning">Warning: </span>collapsing to unique 'x' values</span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> <span class="warning">Warning: </span>collapsing to unique 'x' values</span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> <span class="warning">Warning: </span>collapsing to unique 'x' values</span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> <span class="warning">Warning: </span>collapsing to unique 'x' values</span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> <span class="warning">Warning: </span>collapsing to unique 'x' values</span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> <span class="warning">Warning: </span>collapsing to unique 'x' values</span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> <span class="warning">Warning: </span>collapsing to unique 'x' values</span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> <span class="warning">Warning: </span>collapsing to unique 'x' values</span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> <span class="warning">Warning: </span>collapsing to unique 'x' values</span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> <span class="warning">Warning: </span>collapsing to unique 'x' values</span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> <span class="warning">Warning: </span>collapsing to unique 'x' values</span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> <span class="warning">Warning: </span>collapsing to unique 'x' values</span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> <span class="warning">Warning: </span>collapsing to unique 'x' values</span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> <span class="warning">Warning: </span>collapsing to unique 'x' values</span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> <span class="warning">Warning: </span>collapsing to unique 'x' values</span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> <span class="warning">Warning: </span>collapsing to unique 'x' values</span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> <span class="warning">Warning: </span>collapsing to unique 'x' values</span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> <span class="warning">Warning: </span>collapsing to unique 'x' values</span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> <span class="warning">Warning: </span>collapsing to unique 'x' values</span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> <span class="warning">Warning: </span>collapsing to unique 'x' values</span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> <span class="warning">Warning: </span>collapsing to unique 'x' values</span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> <span class="warning">Warning: </span>collapsing to unique 'x' values</span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> <span class="warning">Warning: </span>collapsing to unique 'x' values</span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> <span class="warning">Warning: </span>collapsing to unique 'x' values</span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> <span class="warning">Warning: </span>collapsing to unique 'x' values</span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> <span class="warning">Warning: </span>collapsing to unique 'x' values</span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> <span class="warning">Warning: </span>collapsing to unique 'x' values</span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> <span class="warning">Warning: </span>collapsing to unique 'x' values</span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> <span class="warning">Warning: </span>collapsing to unique 'x' values</span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> <span class="warning">Warning: </span>collapsing to unique 'x' values</span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> <span class="warning">Warning: </span>collapsing to unique 'x' values</span>
<span class="r-in"><span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/autoplot.html" class="external-link">autoplot</a></span><span class="op">(</span><span class="va">s3</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="pgpTList-4.png" alt="" width="700" height="433"></span>
<span class="r-in"><span></span></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p></p><p>Developed by Yves Deville.</p>
</div>

<div class="pkgdown-footer-right">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
</div>

    </footer></div>

  

  

  </body></html>

