<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><meta name="description" content="Simulate from a `pgpTList` Object. For each of the thresholds of
the object, a collection of n random drawings of the
exeedance events and the related values are provided."><title>Simulate a `pgpTList` Object. — simulate.pgpTList • dailymet</title><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- bootstrap-toc --><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@v1.0.1/dist/bootstrap-toc.min.js" integrity="sha256-4veVQbu7//Lk5TSmc7YV48MxtMy98e26cf5MrgZYnwo=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Simulate a `pgpTList` Object. — simulate.pgpTList"><meta property="og:description" content="Simulate from a `pgpTList` Object. For each of the thresholds of
the object, a collection of n random drawings of the
exeedance events and the related values are provided."><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-light navbar-expand-lg bg-light"><div class="container">
    
    <a class="navbar-brand me-2" href="../index.html">dailymet</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.1.7</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="active nav-item">
  <a class="nav-link" href="../reference/index.html">Reference</a>
</li>
<li class="nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-articles">Articles</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-articles">
    <a class="dropdown-item" href="../articles/Intro.html">R Package `dailymet`: Overview</a>
  </div>
</li>
<li class="nav-item">
  <a class="nav-link" href="../news/index.html">Changelog</a>
</li>
      </ul><form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off"></form>

      <ul class="navbar-nav"></ul></div>

    
  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="" class="logo" alt=""><h1>Simulate a `pgpTList` Object.</h1>
      
      <div class="d-none name"><code>simulate.pgpTList.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>Simulate from a `pgpTList` Object. For each of the thresholds of
the object, a collection of <code>n</code> random drawings of the
exeedance events and the related values are provided.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="co"># S3 method for pgpTList</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/stats/simulate.html" class="external-link">simulate</a></span><span class="op">(</span></span>
<span>  <span class="va">object</span>,</span>
<span>  nsim <span class="op">=</span> <span class="fl">1</span>,</span>
<span>  seed <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  <span class="va">newdata</span>,</span>
<span>  lastFullYear <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  tailOnly <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  tau <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  trace <span class="op">=</span> <span class="fl">0</span>,</span>
<span>  how <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"list"</span>, <span class="st">"vector"</span>, <span class="st">"data.frame"</span><span class="op">)</span>,</span>
<span>  <span class="va">...</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>
    <dl><dt>object</dt>
<dd><p>A <code>pgpTList</code> object representing a list of
Poisson-GP fitted models</p></dd>


<dt>nsim</dt>
<dd><p>Number of simulation wanted.</p></dd>


<dt>seed</dt>
<dd><p>Not used yet.</p></dd>


<dt>newdata</dt>
<dd><p>An optional object that giving the "new" dates for
which the simulation will be done. It can simply be an object
with class <code>"Date"</code> or an object with class
<code>"dailyMet"</code>. Depending on the class of <code>newdata</code>,
the variables required for the prediction (such as sine waves)
will be recomputed or not. When <code>newdata</code> is not given or
is <code>NULL</code>, <code>object$data</code> is used.</p></dd>


<dt>lastFullYear</dt>
<dd><p>Logical, used only when <code>newdata</code> is not
provided or is <code>NULL</code>. When <code>TRUE</code>, only the last
full year in the data used when fitting the object will be
used.</p></dd>


<dt>tailOnly</dt>
<dd><p>Logical. If <code>TRUE</code> the simulation will be
only for tail events. More precisely only for each of the
threshold \(u_i(t)\) corresponding to a non-exceedance
probability \(\tau_i\) the maximum \(v_i:=\max_t
u_i(t)\) of the the thresholds over the predicted period is
computed, and the simulated events correspond to exceedances
over \(v_i\).</p></dd>


<dt>tau</dt>
<dd><p>If provided, the simulation is only made for the
provided value of <code>tau</code>.</p></dd>


<dt>trace</dt>
<dd><p>Integer level of verbosity.</p></dd>


<dt>how</dt>
<dd><p>A technical argument telling how the big data frame on
output is to be constructed by concatenation. The
<code>"list"</code> method (default and recommended) makes a list
containing a large number of data frames, one by simulation
and then makes use of the very efficient
<code><a href="https://rdatatable.gitlab.io/data.table/reference/rbindlist.html" class="external-link">rbindlist</a></code> function. With
<code>"vector"</code>, once concatenates vectors, and with
<code>"data.frame"</code> one rbinds data fames at each
simulation. The tow later options are by far slower when
<code>n</code> is large, say <code>n &gt; 100</code>.</p></dd>


<dt>...</dt>
<dd><p>Not used yet.</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    

<p>An object with class <code>"summary.pgpTList"</code>, inheriting
    from the <code>"data.frame"</code> class. This is a data frame in
    long format containing the simulated events with the
    corresponding simulated values of the meteorological variable.</p>
    </div>
    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>
    <p>The thresholds and hence the exceedance events are related to a
probability <code>tau</code> of non-exceedance which is quite high, say
0.95 or more. Note that even if the GP model for the excesses over
the threshold is perfectly adequate, the simulated exceedance
events come at a rate which is smaller than the real rate because
the simulation is based on <em>declustered</em> exceedance
events. So for a given date, if a large number <code>n</code> of
simulations is used, the frequency of the exceedance will be
smaller than the real one.</p>
    </div>
    <div class="section level2">
    <h2 id="note">Note<a class="anchor" aria-label="anchor" href="#note"></a></h2>
    <p>In the returned data frame, the (factor) column <code>Sim</code>
    gives the simulation number. It can happen that a simulation
    generates no event, especially if <code>tau</code> is close to 1
    and if the simulation period is short.</p>
    </div>
    <div class="section level2">
    <h2 id="caution">Caution<a class="anchor" aria-label="anchor" href="#caution"></a></h2>
    <p>the returned data frame can be very large since
    <code>n</code> simulations are made for each value of <code>tau</code>,
    and each simulation can will typically give several dozens of
    events.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="va">RqU</span> <span class="op">&lt;-</span> <span class="fu"><a href="rqTList.html">rqTList</a></span><span class="op">(</span>dailyMet <span class="op">=</span> <span class="va">Rennes</span>, tau <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.94</span>, <span class="fl">0.95</span>, <span class="fl">0.96</span>, <span class="fl">0.97</span>, <span class="fl">0.98</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">Pgp1</span> <span class="op">&lt;-</span> <span class="fu"><a href="pgpTList.html">pgpTList</a></span><span class="op">(</span>dailyMet <span class="op">=</span> <span class="va">Rennes</span>, thresholds <span class="op">=</span> <span class="va">RqU</span>, declust <span class="op">=</span> <span class="cn">TRUE</span>,</span></span>
<span class="r-in"><span>                 fitLambda <span class="op">=</span> <span class="cn">TRUE</span>, logLambda.fun <span class="op">=</span> <span class="op">~</span><span class="va">YearNum</span> <span class="op">-</span> <span class="fl">1</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> o Using meteorological variable : "TX"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> o Adding new variables </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> o Using K = 3 and the following phases</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> sinjPhi1 sinjPhi2 sinjPhi3 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   105.94     8.53    84.21 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> o Sampling rate : 365.26/year</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> o Looping on 5 thresholds</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> o Fit the temporal Poisson process:  non-homogeneous</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Number of observations  not used in the estimation process:  0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Total number of time observations:  28366</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Number of events:  772</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Convergence code:  0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Convergence attained</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Loglikelihood:  -3537.078</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Estimated coefficients: </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     b0     b1 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> -3.757  0.009 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Full coefficients: </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     b0     b1 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> -3.757  0.009 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> attr(,"TypeCoeff")</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "Fixed: No  fixed parameters"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> o Fit the temporal Poisson process:  non-homogeneous</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Number of observations  not used in the estimation process:  0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Total number of time observations:  28366</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Number of events:  671</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Convergence code:  0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Convergence attained</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Loglikelihood:  -3165.859</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Estimated coefficients: </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     b0     b1 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> -3.912  0.010 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Full coefficients: </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     b0     b1 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> -3.912  0.010 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> attr(,"TypeCoeff")</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "Fixed: No  fixed parameters"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> o Fit the temporal Poisson process:  non-homogeneous</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Number of observations  not used in the estimation process:  0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Total number of time observations:  28366</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Number of events:  565</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Convergence code:  0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Convergence attained</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Loglikelihood:  -2762.467</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Estimated coefficients: </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     b0     b1 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> -4.087  0.010 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Full coefficients: </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     b0     b1 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> -4.087  0.010 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> attr(,"TypeCoeff")</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "Fixed: No  fixed parameters"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> o Fit the temporal Poisson process:  non-homogeneous</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Number of observations  not used in the estimation process:  0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Total number of time observations:  28366</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Number of events:  450</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Convergence code:  0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Convergence attained</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Loglikelihood:  -2299.813</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Estimated coefficients: </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     b0     b1 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> -4.337  0.012 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Full coefficients: </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     b0     b1 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> -4.337  0.012 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> attr(,"TypeCoeff")</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "Fixed: No  fixed parameters"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> o Fit the temporal Poisson process:  non-homogeneous</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Number of observations  not used in the estimation process:  0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Total number of time observations:  28366</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Number of events:  323</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Convergence code:  0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Convergence attained</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Loglikelihood:  -1749.224</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Estimated coefficients: </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     b0     b1 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> -4.754  0.016 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Full coefficients: </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     b0     b1 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> -4.754  0.016 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> attr(,"TypeCoeff")</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "Fixed: No  fixed parameters"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-in"><span><span class="va">Date</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span>from <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/as.Date.html" class="external-link">as.Date</a></span><span class="op">(</span><span class="st">"2022-01-01"</span><span class="op">)</span>, to <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/as.Date.html" class="external-link">as.Date</a></span><span class="op">(</span><span class="st">"2043-01-01"</span><span class="op">)</span>, by <span class="op">=</span> <span class="st">"day"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">st</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/system.time.html" class="external-link">system.time</a></span><span class="op">(</span><span class="va">sim</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/simulate.html" class="external-link">simulate</a></span><span class="op">(</span><span class="va">Pgp1</span>, nsim <span class="op">=</span> <span class="fl">8</span>, newdata <span class="op">=</span> <span class="va">Date</span>, trace <span class="op">=</span> <span class="fl">1</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> tau=0.94 tau=0.95 tau=0.96 tau=0.97 tau=0.98 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     0.94     0.95     0.96     0.97     0.98 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> tau =  0.94</span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> <span class="warning">Warning: </span>collapsing to unique 'x' values</span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> <span class="warning">Warning: </span>collapsing to unique 'x' values</span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> <span class="warning">Warning: </span>collapsing to unique 'x' values</span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> <span class="warning">Warning: </span>collapsing to unique 'x' values</span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> <span class="warning">Warning: </span>collapsing to unique 'x' values</span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> <span class="warning">Warning: </span>collapsing to unique 'x' values</span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> <span class="warning">Warning: </span>collapsing to unique 'x' values</span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> <span class="warning">Warning: </span>collapsing to unique 'x' values</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> tau =  0.95</span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> <span class="warning">Warning: </span>collapsing to unique 'x' values</span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> <span class="warning">Warning: </span>collapsing to unique 'x' values</span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> <span class="warning">Warning: </span>collapsing to unique 'x' values</span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> <span class="warning">Warning: </span>collapsing to unique 'x' values</span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> <span class="warning">Warning: </span>collapsing to unique 'x' values</span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> <span class="warning">Warning: </span>collapsing to unique 'x' values</span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> <span class="warning">Warning: </span>collapsing to unique 'x' values</span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> <span class="warning">Warning: </span>collapsing to unique 'x' values</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> tau =  0.96</span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> <span class="warning">Warning: </span>collapsing to unique 'x' values</span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> <span class="warning">Warning: </span>collapsing to unique 'x' values</span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> <span class="warning">Warning: </span>collapsing to unique 'x' values</span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> <span class="warning">Warning: </span>collapsing to unique 'x' values</span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> <span class="warning">Warning: </span>collapsing to unique 'x' values</span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> <span class="warning">Warning: </span>collapsing to unique 'x' values</span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> <span class="warning">Warning: </span>collapsing to unique 'x' values</span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> <span class="warning">Warning: </span>collapsing to unique 'x' values</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> tau =  0.97</span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> <span class="warning">Warning: </span>collapsing to unique 'x' values</span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> <span class="warning">Warning: </span>collapsing to unique 'x' values</span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> <span class="warning">Warning: </span>collapsing to unique 'x' values</span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> <span class="warning">Warning: </span>collapsing to unique 'x' values</span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> <span class="warning">Warning: </span>collapsing to unique 'x' values</span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> <span class="warning">Warning: </span>collapsing to unique 'x' values</span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> <span class="warning">Warning: </span>collapsing to unique 'x' values</span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> <span class="warning">Warning: </span>collapsing to unique 'x' values</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> tau =  0.98</span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> <span class="warning">Warning: </span>collapsing to unique 'x' values</span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> <span class="warning">Warning: </span>collapsing to unique 'x' values</span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> <span class="warning">Warning: </span>collapsing to unique 'x' values</span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> <span class="warning">Warning: </span>collapsing to unique 'x' values</span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> <span class="warning">Warning: </span>collapsing to unique 'x' values</span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> <span class="warning">Warning: </span>collapsing to unique 'x' values</span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> <span class="warning">Warning: </span>collapsing to unique 'x' values</span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> <span class="warning">Warning: </span>collapsing to unique 'x' values</span>
<span class="r-in"><span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/autoplot.html" class="external-link">autoplot</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/subset.html" class="external-link">subset</a></span><span class="op">(</span><span class="va">sim</span>, <span class="va">tau</span> <span class="op">==</span> <span class="fl">0.95</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="simulate.pgpTList-1.png" alt="" width="700" height="433"></span>
<span class="r-in"><span><span class="co">## more realistic example</span></span></span>
<span class="r-in"><span><span class="kw">if</span> <span class="op">(</span><span class="cn">FALSE</span><span class="op">)</span> <span class="op">{</span></span></span>
<span class="r-in"><span>    <span class="va">pred</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/predict.html" class="external-link">predict</a></span><span class="op">(</span><span class="va">Pgp1</span>, newdata <span class="op">=</span> <span class="va">Date</span><span class="op">)</span></span></span>
<span class="r-in"><span>    <span class="va">st</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/system.time.html" class="external-link">system.time</a></span><span class="op">(</span><span class="va">sim</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/simulate.html" class="external-link">simulate</a></span><span class="op">(</span><span class="va">Pgp1</span>, nsim <span class="op">=</span> <span class="fl">1000</span>, newdata <span class="op">=</span> <span class="va">Date</span>, trace <span class="op">=</span> <span class="fl">1</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span>    <span class="co">## compute the maximum 'M' on the period by simulation and by threshold</span></span></span>
<span class="r-in"><span>    <span class="va">M</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/with.html" class="external-link">with</a></span><span class="op">(</span><span class="va">sim</span>, <span class="fu"><a href="https://rdrr.io/r/base/tapply.html" class="external-link">tapply</a></span><span class="op">(</span><span class="va">TX</span>, <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="va">Sim</span>, <span class="va">tau</span><span class="op">)</span>, <span class="va">max</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span>    <span class="co">## quantile over the simulation (by threshold)</span></span></span>
<span class="r-in"><span>    <span class="fu"><a href="https://rdrr.io/r/base/apply.html" class="external-link">apply</a></span><span class="op">(</span><span class="va">M</span>, <span class="fl">2</span>, <span class="va">quantile</span>, prob <span class="op">=</span> <span class="fl">0.99</span>, na.rm <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></span>
<span class="r-in"><span>    <span class="co">## compare with the computation</span></span></span>
<span class="r-in"><span>    <span class="fu"><a href="https://rdrr.io/r/stats/quantile.html" class="external-link">quantile</a></span><span class="op">(</span><span class="va">pred</span>, p <span class="op">=</span> <span class="fl">0.99</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="op">}</span></span></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p></p><p>Developed by Yves Deville.</p>
</div>

<div class="pkgdown-footer-right">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
</div>

    </footer></div>

  

  

  </body></html>

