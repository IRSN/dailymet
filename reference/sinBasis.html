<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><meta name="description" content="Basis of sine wave functions \(s_k(t)\) with the phases
\(\phi_k\) given in phi corresponding to the periods
\(365.25 / k\)."><title>Create a Basis of Sine Waves with Given Phases — sinBasis • dailymet</title><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- bootstrap-toc --><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@v1.0.1/dist/bootstrap-toc.min.js" integrity="sha256-4veVQbu7//Lk5TSmc7YV48MxtMy98e26cf5MrgZYnwo=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Create a Basis of Sine Waves with Given Phases — sinBasis"><meta property="og:description" content="Basis of sine wave functions \(s_k(t)\) with the phases
\(\phi_k\) given in phi corresponding to the periods
\(365.25 / k\)."><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-light navbar-expand-lg bg-light"><div class="container">
    
    <a class="navbar-brand me-2" href="../index.html">dailymet</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.1.7</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="active nav-item">
  <a class="nav-link" href="../reference/index.html">Reference</a>
</li>
<li class="nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-articles">Articles</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-articles">
    <a class="dropdown-item" href="../articles/Intro.html">R Package `dailymet`: Overview</a>
  </div>
</li>
<li class="nav-item">
  <a class="nav-link" href="../news/index.html">Changelog</a>
</li>
      </ul><form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off"></form>

      <ul class="navbar-nav"></ul></div>

    
  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="" class="logo" alt=""><h1>Create a Basis of Sine Waves with Given Phases</h1>
      
      <div class="d-none name"><code>sinBasis.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>Basis of sine wave functions \(s_k(t)\) with the phases
\(\phi_k\) given in <code>phi</code> corresponding to the periods
\(365.25 / k\).</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">sinBasis</span><span class="op">(</span><span class="va">dt</span>, df <span class="op">=</span> <span class="fl">7</span>, <span class="va">phi</span>, cst <span class="op">=</span> <span class="cn">TRUE</span>, keepTrig <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>
    <dl><dt>dt</dt>
<dd><p>A vector with class <code>"Date"</code> or <code>"POSIXct"</code>
representing the days at which the sine waves basis functions
are to be evaluated.</p></dd>


<dt>df</dt>
<dd><p>Odd number as in <code><a href="tsDesign.html">tsDesign</a></code>.</p></dd>


<dt>phi</dt>
<dd><p>Vector of \(K\) phases where \(K\) is equal to
<code>(df - 1) / 2</code>.</p></dd>


<dt>cst</dt>
<dd><p>Logical. If <code>TRUE</code> a constant column with value
1.0 is added as a first column.</p></dd>


<dt>keepTrig</dt>
<dd><p>Logical. If <code>TRUE</code>, the cos-sin functions are
joined as columns of the result. So the returned matrix then
does not correspond to a basis. Used mainly for tests.</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    

<p>A numeric matrix containing as columns the \(K\) basis
    functions \(s_k(t)\), and with its rows corresponding to the
    time \(t\) given by <code>Date</code>. The names of the \(K\)</p>


<p>sine wave function have the prefix <code>"sinjPhi"</code> so are</p>
<p></p>
<p><code>"sinjPhi1"</code>, <code>"sinPhij2"</code>, ... This is aimed to
    recall that the phases \(\phi_k\) were given. If <code>cst</code></p>


<p>is <code>TRUE</code> and <code>keepTrig</code> a constant column with
    value 1.0 is added, and if <code>keepTrig</code> is <code>TRUE</code> the
    trigonometric functions (with phase zero) are added as well.</p>
    </div>
    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>
    <p>For a time \(t\) the value of the \(k\)-th function is given
by</p>
<p>$$s_k(t) := \sin\{2 \pi k [j_t - \phi_k] / 365.25)$$</p>
<p>for \(k=1\) to K, where \(j_t\) is the Julian day
corresponding to \(t\). This function is useful to provide a
basis of functions with yearly seasonality that are suitable for
meteorological variables. For instance the phase for the first
harmonic of the daily temperature in France is such that the
annual maximal temperature "normally" happen at the end of July.</p>
    </div>
    <div class="section level2">
    <h2 id="note">Note<a class="anchor" aria-label="anchor" href="#note"></a></h2>
    <p>This functions uses the <code><a href="tsDesign.html">tsDesign</a></code> function with
    <code>type = "trigo"</code>.</p>
    </div>
    <div class="section level2">
    <h2 id="caution">Caution<a class="anchor" aria-label="anchor" href="#caution"></a></h2>
    <p>This function is likely to be removed. It is
    safer to use <code><a href="tsDesign.html">tsDesign</a></code> with the argument
    <code>phi</code>.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="co">## Use only full years to maintain near orthogonality</span></span></span>
<span class="r-in"><span><span class="va">df</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/subset.html" class="external-link">subset</a></span><span class="op">(</span><span class="va">Rennes</span>, <span class="va">Year</span> <span class="op">&lt;=</span> <span class="fl">2020</span> <span class="op">&amp;</span> <span class="va">Year</span> <span class="op">&gt;=</span> <span class="fl">1960</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">K</span> <span class="op">&lt;-</span> <span class="fl">3</span></span></span>
<span class="r-in"><span><span class="co">## Design of trigonometric functions</span></span></span>
<span class="r-in"><span><span class="va">desTrig</span> <span class="op">&lt;-</span> <span class="fu"><a href="tsDesign.html">tsDesign</a></span><span class="op">(</span>dt <span class="op">=</span> <span class="va">df</span><span class="op">$</span><span class="va">Date</span>, df <span class="op">=</span> <span class="fl">2</span> <span class="op">*</span> <span class="va">K</span> <span class="op">+</span> <span class="fl">1</span>, type <span class="op">=</span> <span class="st">"trigo"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">fit</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/lm.html" class="external-link">lm</a></span><span class="op">(</span>formula <span class="op">=</span> <span class="va">TX</span> <span class="op">~</span> <span class="va">Cst</span> <span class="op">+</span> <span class="va">cosj1</span> <span class="op">+</span> <span class="va">sinj1</span> <span class="op">+</span> <span class="va">cosj2</span> <span class="op">+</span> <span class="va">sinj2</span> <span class="op">+</span> <span class="va">cosj3</span> <span class="op">+</span> <span class="va">sinj3</span> <span class="op">-</span> <span class="fl">1</span>,</span></span>
<span class="r-in"><span>          data <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span><span class="va">df</span>, <span class="va">desTrig</span><span class="op">$</span><span class="va">X</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">betaHat</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/coef.html" class="external-link">coef</a></span><span class="op">(</span><span class="va">fit</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## find the phases</span></span></span>
<span class="r-in"><span><span class="va">phiHat</span> <span class="op">&lt;-</span> <span class="fu"><a href="phases.html">phases</a></span><span class="op">(</span><span class="va">betaHat</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">gamma</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/attr.html" class="external-link">attr</a></span><span class="op">(</span><span class="va">phiHat</span>, <span class="st">"amplitude"</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## Design of sine waves with prescribed phases</span></span></span>
<span class="r-in"><span><span class="va">desSin</span> <span class="op">&lt;-</span> <span class="fu"><a href="tsDesign.html">tsDesign</a></span><span class="op">(</span>dt <span class="op">=</span> <span class="va">df</span><span class="op">$</span><span class="va">Date</span>, df <span class="op">=</span> <span class="fl">2</span> <span class="op">*</span> <span class="va">K</span> <span class="op">+</span> <span class="fl">1</span>,</span></span>
<span class="r-in"><span>                   type <span class="op">=</span> <span class="st">"sinwave"</span>, phi <span class="op">=</span> <span class="va">phiHat</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">fit2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/lm.html" class="external-link">lm</a></span><span class="op">(</span>formula <span class="op">=</span> <span class="va">TX</span> <span class="op">~</span> <span class="va">Cst</span> <span class="op">+</span> <span class="va">sinjPhi1</span> <span class="op">+</span> <span class="va">sinjPhi2</span> <span class="op">+</span> <span class="va">sinjPhi3</span> <span class="op">-</span><span class="fl">1</span>,</span></span>
<span class="r-in"><span>           data <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span><span class="va">df</span>, <span class="va">desSin</span><span class="op">$</span><span class="va">X</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="co">## should be zero</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/Extremes.html" class="external-link">max</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/MathFun.html" class="external-link">abs</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/predict.html" class="external-link">predict</a></span><span class="op">(</span><span class="va">fit</span><span class="op">)</span> <span class="op">-</span> <span class="fu"><a href="https://rdrr.io/r/stats/predict.html" class="external-link">predict</a></span><span class="op">(</span><span class="va">fit2</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 1.24345e-14</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## the amplitude and the coef</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">rbind</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/coef.html" class="external-link">coef</a></span><span class="op">(</span><span class="va">fit2</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="cn">NA</span>, <span class="va">gamma</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>           Cst sinjPhi1  sinjPhi2   sinjPhi3</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1,] 16.20282 7.937385 0.8769553 0.04824877</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [2,]       NA 7.937385 0.8769553 0.04824877</span>
<span class="r-in"><span><span class="va">j</span> <span class="op">&lt;-</span> <span class="fl">3</span></span></span>
<span class="r-in"><span><span class="va">indTrig</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"cosj"</span>, <span class="st">"sinj"</span><span class="op">)</span>, <span class="va">j</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">indSin</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="st">"sinjPhi"</span>, <span class="va">j</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">desTrig</span><span class="op">$</span><span class="va">X</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">366</span> , <span class="va">indTrig</span><span class="op">]</span> <span class="op"><a href="https://rdrr.io/r/base/matmult.html" class="external-link">%*%</a></span> <span class="va">betaHat</span><span class="op">[</span><span class="va">indTrig</span><span class="op">]</span>, type <span class="op">=</span> <span class="st">"l"</span>,</span></span>
<span class="r-in"><span>     col <span class="op">=</span> <span class="st">"SpringGreen3"</span>, xlab <span class="op">=</span> <span class="st">""</span>, ylab <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste</a></span><span class="op">(</span><span class="st">"harmonic"</span>, <span class="va">j</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/graphics/lines.html" class="external-link">lines</a></span><span class="op">(</span><span class="va">desSin</span><span class="op">$</span><span class="va">X</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">366</span>, <span class="va">indSin</span><span class="op">]</span> <span class="op">*</span> <span class="va">gamma</span><span class="op">[</span><span class="va">j</span><span class="op">]</span>, col <span class="op">=</span> <span class="st">"red"</span>, lwd <span class="op">=</span> <span class="fl">2</span>, lty <span class="op">=</span> <span class="st">"dashed"</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="sinBasis-1.png" alt="" width="700" height="433"></span>
<span class="r-in"><span></span></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p></p><p>Developed by Yves Deville.</p>
</div>

<div class="pkgdown-footer-right">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
</div>

    </footer></div>

  

  

  </body></html>

